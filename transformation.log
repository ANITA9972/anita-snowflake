2025-12-12 10:54:11,549 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.1.1, Python Version: 3.13.9, Platform: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
2025-12-12 10:54:11,551 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-12-12 10:54:15,783 - __main__ - INFO - Starting data transformation...
2025-12-12 10:54:15,785 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.1.1, Python Version: 3.13.9, Platform: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
2025-12-12 10:54:15,786 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-12-12 10:54:17,621 - __main__ - INFO - Silver tables created/verified
2025-12-12 10:54:17,760 - __main__ - INFO - Columns in bronze table: ['CITY_ID', 'CITY_NAME', 'COUNTRY_CODE', 'DATE', 'CLIMATE_ZONE', 'HEMISPHERE', 'HOURLY_READINGS', 'AVG_TEMPERATURE', 'MIN_TEMPERATURE', 'MAX_TEMPERATURE', 'TEMPERATURE_VARIABILITY', 'AVG_HUMIDITY', 'MIN_HUMIDITY', 'MAX_HUMIDITY', 'AVG_WIND_SPEED', 'MAX_WIND_SPEED', 'AVG_PRESSURE', 'AVG_COMFORT_INDEX', 'DOMINANT_WEATHER', 'WEATHER_CHANGES_COUNT', 'DAILY_TEMP_RANGE', 'TEMPERATURE_STABILITY', 'COMFORT_CATEGORY', 'LOAD_TIMESTAMP']
2025-12-12 10:54:17,761 - __main__ - INFO - Executing query: 
            SELECT 
                CITY_ID as CITY_ID, CITY_NAME as CITY_NAME, COUNTRY_CODE as COUNTRY_CODE, NULL as LATITUDE, NULL as LONGITUDE, LOAD_TIMESTAMP as TIMESTAMP, 'UNKNOWN' as WEATHER_MA...
2025-12-12 10:54:18,564 - __main__ - ERROR - Error fetching bronze data: Execution failed on sql '
            SELECT 
                CITY_ID as CITY_ID, CITY_NAME as CITY_NAME, COUNTRY_CODE as COUNTRY_CODE, NULL as LATITUDE, NULL as LONGITUDE, LOAD_TIMESTAMP as TIMESTAMP, 'UNKNOWN' as WEATHER_MAIN, 'UNKNOWN' as WEATHER_DESCRIPTION, TEMPERATURE_STABILITY as TEMPERATURE, NULL as FEELS_LIKE, NULL as TEMP_MIN, NULL as TEMP_MAX, AVG_PRESSURE as PRESSURE, MAX_HUMIDITY as HUMIDITY, MAX_WIND_SPEED as WIND_SPEED, NULL as WIND_DEG, NULL as CLOUD_COVERAGE, CURRENT_DATE() as INGESTION_DATE
            FROM BRONZE.CURRENT_WEATHER_RAW
            WHERE 
                COALESCE(
                    INGESTION_DATE,
                    ingestion_date,
                    loaded_at,
                    CURRENT_DATE()
                ) >= CURRENT_DATE() - 1
            ORDER BY 
                COALESCE(
                    TIMESTAMP,
                    timestamp,
                    dt,
                    CURRENT_TIMESTAMP()
                ) DESC
            ': 000904 (42000): 01c0ff1a-000c-b7f8-0000-49ed000369a2: SQL compilation error: error line 8 at position 20
invalid identifier 'LOADED_AT'
2025-12-12 10:54:18,565 - __main__ - ERROR - Transformation failed: Execution failed on sql '
            SELECT 
                CITY_ID as CITY_ID, CITY_NAME as CITY_NAME, COUNTRY_CODE as COUNTRY_CODE, NULL as LATITUDE, NULL as LONGITUDE, LOAD_TIMESTAMP as TIMESTAMP, 'UNKNOWN' as WEATHER_MAIN, 'UNKNOWN' as WEATHER_DESCRIPTION, TEMPERATURE_STABILITY as TEMPERATURE, NULL as FEELS_LIKE, NULL as TEMP_MIN, NULL as TEMP_MAX, AVG_PRESSURE as PRESSURE, MAX_HUMIDITY as HUMIDITY, MAX_WIND_SPEED as WIND_SPEED, NULL as WIND_DEG, NULL as CLOUD_COVERAGE, CURRENT_DATE() as INGESTION_DATE
            FROM BRONZE.CURRENT_WEATHER_RAW
            WHERE 
                COALESCE(
                    INGESTION_DATE,
                    ingestion_date,
                    loaded_at,
                    CURRENT_DATE()
                ) >= CURRENT_DATE() - 1
            ORDER BY 
                COALESCE(
                    TIMESTAMP,
                    timestamp,
                    dt,
                    CURRENT_TIMESTAMP()
                ) DESC
            ': 000904 (42000): 01c0ff1a-000c-b7f8-0000-49ed000369a2: SQL compilation error: error line 8 at position 20
invalid identifier 'LOADED_AT'
